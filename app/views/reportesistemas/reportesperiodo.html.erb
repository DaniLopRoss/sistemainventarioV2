<head>
    <%= stylesheet_link_tag "style" %>

</head>
<div align="center">

    <h5>Mantenimiento</h5>

    <div class="col-lg-12 grid-margin stretch-card">
        <div class="card">
            <div class="card-body">
            <div class="filtrar">
            <%= form_tag(reportesperiodo_path, method: "get", class: "form-inline") do %>
              <div class="form-grou">
                <%= label_tag(:start_date, "Desde:") %>
                <%= date_field_tag(:start_date, params[:start_date], class: "form-contro") %>
              </div>
              <div class="form-grou mx-2">
                <%= label_tag(:end_date, "Hasta:") %>
                <%= date_field_tag(:end_date, params[:end_date], class: "form-contro") %>
              </div>
              <br>
              </br>
              <%= button_tag(type: 'submit', class: 'btn my-submit-button') do %>
                <i class='bi bi-funnel'></i>
              <% end %>
            <% end %>
          </div>
          <br>
          </br>
          <div class="table-responsive pt-3">
            <table class="table table-bordered" id="tablaman">
              <thead class="thead-blue">
                <tr>
                  <th></th>
                  <th scope="col">Zona</th>
                  <th scope="col">Fecha</th>
                  <th scope="col">Mantenimientos por zona</th>
                </tr>
              </thead>
              <tbody>
              <% @maintenance_count_by_zone_and_date.each do |(zone, date), maintenances| %>
                <tr>
                  <td></td>
                  <td><%= zone %></td>
                  <td><%= date %></td>
                  <td><%= maintenances.count %></td>
                </tr>
              <% end %>
            </tbody>
            
            </table>
          </div>
            </div>
        </div>
    </div>

    <script>
        $(document).ready(function() {
            var oTable = $("#tablaman").DataTable({
                language: {
                    url: '//cdn.datatables.net/plug-ins/1.13.1/i18n/es-MX.json'
                },
                responsive: "true",
                dom: 'Bfrtilp',
                buttons: [{
                        extend: 'excelHtml5',
                        text: '<i class="bi bi-file-earmark-excel"></i> ',
                        titleAttr: 'Exportar a Excel',
                        className: 'btn btn-success'
                    },
                    {
                        extend: 'pdfHtml5',
                        text: '<i class="bi bi-file-earmark-pdf"></i> ',
                        titleAttr: 'Exportar a PDF',
                        className: 'btn btn-danger'
                    },
                    {
                        extend: 'print',
                        text: '<i class="bi bi-printer"></i> ',
                        titleAttr: 'Imprimir',
                        className: 'btn btn-info'
                    },
                ],
                columnDefs: [{
                    sortable: false,
                    "class": "index",
                    targets: 0
                }],
                order: [
                    [1, 'asc']
                ],
                fixedColumns: true
            });
            oTable.on('order.dt search.dt', function() {
                oTable.column(0, {
                    search: 'applied',
                    order: 'applied'
                }).nodes().each(function(cell, i) {
                    cell.innerHTML = i + 1;
                });
            }).draw();
        });
    </script>